
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Seamless Windows Virtualization - My Delusional Dream</title>
  <meta name="author" content="Patrick Wagstrom">

  
  <meta name="description" content="Seamless Windows Virtualization Apr 27th, 2008 | var idcomments_acct = 'de6c2d3e38f6fdb9bf16fa9f1904f35d';
var idcomments_post_id;
var &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://patrick.wagstrom.net/weblog/2008/04/27/seamless-virtualization">
  <link href="/weblog/favicon.png" rel="icon">
  <link href="/weblog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/weblog/javascripts/modernizr-2.0.js"></script>
  <script src="/weblog/javascripts/ender.js"></script>
  <script src="/weblog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/weblog/atom.xml" rel="alternate" title="My Delusional Dream" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/weblog/">My Delusional Dream</a></h1>
  
    <h2>Thoughts of a cautious technocrat</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/weblog/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:patrick.wagstrom.net/weblog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/weblog/">Blog</a></li>
  <li><a href="/weblog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Seamless Windows Virtualization</h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-04-27T15:12:00-04:00" pubdate data-updated="true">Apr 27<span>th</span>, 2008</time>
        
        
         | 

<script>
var idcomments_acct = 'de6c2d3e38f6fdb9bf16fa9f1904f35d';
var idcomments_post_id;
var idcomments_post_url;
</script>
<script type="text/javascript" src="http://www.intensedebate.com/js/genericLinkWrapperV2.js"></script>


        
      </p>
    
  </header>


<div class="entry-content"><p>Virtualization of desktop operating systems is pretty commonplace for users of Linux and Mac OS.  Initial implementations of desktop virtualization, such as VMWare 1.0, had the guest operating system running in complete isolation.  Interaction was done through a custom application or network applications.  There was no support for sharing files, sharing a clipboard, or merging the windowing environments.</p>

<p>Since then, virtualization has come a very long way.  With VMWare and a supported guest operating system, the clipboards are the same, the mouse isn&#8217;t locked to a window, and files are easily shared between operating system.  Sadly, merging of windowing environments still isn&#8217;t quite there.  Your guest desktop still runs completely in a window on the host.  VMWare has a new technique available in Fusion, their Mac product, called Unity that allows this.  Parallels supports a similar feature called Cohesion, and I&#8217;ve been told that VirtualBox supports this feature too.  This is a fine feature, if you have one of the newer products that supports this.  If you&#8217;re like me and still using VMWare Player, an older version of VMWare workstation, or connecting to remote windows systems with remote desktop, this isn&#8217;t a native feature.  Luckily, it&#8217;s a pretty easy hack to get seamless windows.</p>

<p>Enter <a href="http://www.cendio.com/seamlessrdp/">SeamlessRDP</a> from <a href="http://www.cendio.com/">Cendio</a>.  This little program extends the standard RDP system a little bit to provide for complete desktop integration when using <a href="http://www.rdesktop.org/">rdesktop</a>.  It works in conjunction with rdesktop, so other tools such as tsclient won&#8217;t work.  Unfortunately, the directions for this aren&#8217;t always the most clear, and they didn&#8217;t work with my instance of VMWare, so here&#8217;s how I managed to do it. These instructions are specific to Windows XP Pro.</p>

<p><span>1.</span> First, go and download <a href="http://www.cendio.com/files/thinlinc/seamlessrdp/seamlessrdp.zip">seamlessrdp.zip</a> and extract it to something like <code>c:\windows</code>. There should be three files in there, the one that we really care about is seamlessrdpshell.exe.</p>

<p><span>2.</span> Make sure that that you allow remote connections, go to control panel->system->remote and check &#8220;Allow users to remotely connect to this computer&#8221;.  At this point, you&#8217;ll be able to test a remote desktop connection to your virtual machine through the command rdesktop REMOTESERVERIP.  You&#8217;ll notice that you&#8217;re still running everything in still running a single window because we haven&#8217;t invoked seamlessrdpshell yet.</p>

  <figure class='center'>
        <img src="/weblog/media/2008/04/seamlessrdp-systemProperties.png">
        <figcaption>Enable &#8220;Allow users to remotely connect to this computer </figcaption>
    </figure>


<p><span>3.</span> Enable welcome screen and fast user switching &#8211; this is something that you normally don&#8217;t see in enterprise deployments, but apparently it is necessary for this.  I can&#8217;t figure out how to make it work without this.  Go to control panel->user accounts and check both of the options.</p>

  <figure class='center'>
        <img src="/weblog/media/2008/04/seamlessrdp-userAccountSettings.png">
        <figcaption>Check both options on the user account settings screen </figcaption>
    </figure>


<p><span>4.</span> Tell Explorer to not draw the desktop &#8211; the reason is pretty simple, if explorer drew the desktop the window would still be full screen.  We can change this by creating a new registry in <code>My Computer\HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</code>. Call it <code>NoDesktop</code>, and make it a DWORD with a value of <code>1</code>.  This will keep explorer from drawing the desktop.</p>

  <figure class='center'>
        <img src="/weblog/media/2008/04/seamlessrdp-regedit.png">
        <figcaption>Create a new DWORD registry entry called NoDesktop with a value of 1 </figcaption>
    </figure>


<p><span>5.</span> Here comes some of the stranger stuff, that you may not need to do, but I found necessary for my system and it wasn&#8217;t properly documented anywhere.  In most cases, you can specify an application to run with the -s option to rdesktop, unfortunately, this doesn&#8217;t work on my system.  Instead, we&#8217;ll need to use  a rarely used program that allows you to set system level policies.  Go to start->run and enter <code>gpedit.msc</code>.  Select User Configuration->Administrative Templates->Windows Components->Terminal Services.</p>

  <figure class='center'>
        <img src="/weblog/media/2008/04/seamlessrdp-gpedit.msc.png">
        <figcaption>Run gpedit.msc and navigate down to User Configuration->Administrative Templates->Windows Components->Terminal Services. </figcaption>
    </figure>


<p>Now, the crutch that we&#8217;ll use to select &#8220;Start a program on connection&#8221;.  Double click and check the Enabled box and enter in <code>c:\windows\seamlessrdpshell.exe c:\windows\explorer.exe</code>.  Click apply and then exit.</p>

  <figure class='center'>
        <img src="/weblog/media/2008/04/seamlessrdp-gpedit.mscProp.png">
        <figcaption>Enter c:\windows\seamlessrdpshell.exe c:\windows\explorer.exe for the command to run on connection. </figcaption>
    </figure>


<p><span>6.</span> At this point, if you log out, everything should work, but the graphics may be a bit funny.  In my experience I&#8217;ve found that there are two more small changes necessary before everything works nicely. First, make sure you&#8217;re using the Windows XP appearance and not the classic appearance.  Second, uncheck the option to keep the task bar on top, as this will cause issues when maximizing windows applications.  And finally, you can&#8217;t have another panel on the bottom or the start bar will try to redraw itself poorly, over and over.</p>

  <figure class='center'>
        <img src="/weblog/media/2008/04/seamlessrdp-startMenuProperties.png">
        <figcaption>Uncheck the option to keep the taskbar on top </figcaption>
    </figure>


<p><span>7.</span> Now, all you need to do is make sure you&#8217;re logged out of the virtual machine, and execute the following command: <code>rdesktop -r sound:local -A REMOTESERVERIP:3389 -u "WINDOWSUSER" -p "WINDOWSPASSWORD"</code>.  If everything goes well you should get a nice little windows start menu at the bottom of the screen and your windows apps will run seamlessly. It&#8217;s not 100% perfect, but any sort of virtualization, especially a hack like this, never is.  In particular, sloppy focus causes windows programs to jump to the front.  But other things work great, like a shared clipboard and sound.  It makes working in both worlds lots easier.</p>

  <figure class='center'>
        <img src="/weblog/media/2008/04/seamlessrdp-fulldesktop.png">
        <figcaption>The final product </figcaption>
    </figure>

</div>


<script>
var idcomments_acct = 'de6c2d3e38f6fdb9bf16fa9f1904f35d';
var idcomments_post_id;
var idcomments_post_url;
</script>
<span id="IDCommentsPostTitle" style="display:none"></span>
<script type='text/javascript' src='http://www.intensedebate.com/js/genericCommentWrapperV2.js'></script>




  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Patrick Wagstrom</span></span>

      








  


<time datetime="2008-04-27T15:12:00-04:00" pubdate data-updated="true">Apr 27<span>th</span>, 2008</time>
      

<span class="categories">
  
    <a class='category' href='/weblog/blog/categories/linux/'>linux</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://patrick.wagstrom.net/weblog/2008/04/27/seamless-virtualization/" data-via="pridkett" data-counturl="http://patrick.wagstrom.net/weblog/2008/04/27/seamless-virtualization/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/weblog/2008/04/16/breaking-up-with-liferea/" title="Previous Post: Breaking Up With Liferea">&laquo; Breaking Up With Liferea</a>
      
      
        <a class="basic-alignment right" href="/weblog/2008/07/14/gnome-monitor-resolution/" title="Next Post: Dual Monitor Happiness in GNOME">Dual Monitor Happiness in GNOME &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/weblog/2012/05/10/static-bloggin/">Static Bloggin</a>
      </li>
    
      <li class="post">
        <a href="/weblog/2012/01/28/i-am-not-a-climatologist-and-neither-are-most-of-these-people/">I am not a climatologist, and neither are most of these people</a>
      </li>
    
      <li class="post">
        <a href="/weblog/2012/01/10/looking-for-summer-interns-in-the-software-technology-group-at-ibm-tj-watson-research-center/">Looking for Summer Interns in the Software Technology Group at IBM TJ Watson Research Center</a>
      </li>
    
      <li class="post">
        <a href="/weblog/2012/01/03/a-review-of-2011-personal-development-goals/">A Review of 2011 Personal Development Goals</a>
      </li>
    
      <li class="post">
        <a href="/weblog/2012/01/03/open-source-and-technology-predictions-for-2012/">Open Source and Technology Predictions for 2012</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/pridkett">@pridkett</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'pridkett',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/weblog/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("pridkett", 4, false);
    });
  </script>
  <script src="/weblog/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/pridkett" class="twitter-follow-button" data-show-count="false">Follow @pridkett</a>
  
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/102672530623465237388?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Patrick Wagstrom -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
