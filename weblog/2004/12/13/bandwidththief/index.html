
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Stopping Bandwidth Thieves - My Delusional Dream</title>
  <meta name="author" content="Patrick Wagstrom">

  
  <meta name="description" content="Stopping Bandwidth Thieves Dec 13th, 2004 | var idcomments_acct = 'de6c2d3e38f6fdb9bf16fa9f1904f35d';
var idcomments_post_id;
var &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://patrick.wagstrom.net/weblog/2004/12/13/bandwidththief">
  <link href="/weblog/favicon.png" rel="icon">
  <link href="/weblog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/weblog/javascripts/modernizr-2.0.js"></script>
  <script src="/weblog/javascripts/ender.js"></script>
  <script src="/weblog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/weblog/atom.xml" rel="alternate" title="My Delusional Dream" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/weblog/">My Delusional Dream</a></h1>
  
    <h2>Thoughts of a cautious technocrat</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/weblog/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:patrick.wagstrom.net/weblog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/weblog/">Blog</a></li>
  <li><a href="/weblog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Stopping Bandwidth Thieves</h1>
    
    
      <p class="meta">
        








  


<time datetime="2004-12-13T18:32:00-05:00" pubdate data-updated="true">Dec 13<span>th</span>, 2004</time>
        
        
         | 

<script>
var idcomments_acct = 'de6c2d3e38f6fdb9bf16fa9f1904f35d';
var idcomments_post_id;
var idcomments_post_url;
</script>
<script type="text/javascript" src="http://www.intensedebate.com/js/genericLinkWrapperV2.js"></script>


        
      </p>
    
  </header>


<div class="entry-content"><p>I&#8217;m progressing well on my war to reclaim bandwidth back from spammers
and other nefarious foul beasts who can barely be classified as human.
Today I had to take a step that I&#8217;d rather not do because it becomes a
real pain in the butt, but nonetheless, I needed to do it.</p>

<p>One of the wonderful things about the web is the ability to link to
any document anywhere on the web.  This is great because it means that
we don&#8217;t need to follow extended instructions on how to locate a
document on a server.  We should all be happy that
<a href="http://www.gigalaw.com/articles/2000-all/kubiszyn-2000-05b-all.html">deep-linking is protected</a>
and that we don&#8217;t need to sign asinine
<a href="http://www.google.com/search?q=%22link+agreement%22">link agreements</a>
to link to websites.  However, for people who run their site off a low
bandwidth link (my cable modem in my case), this can sometimes be a
bad thing.</p>

<p>The problem occurs when that linking turns into bandwidth thievery.
You know, when people post an image or a graphic and pretend like it&#8217;s
theirs but really just link to yours.  Yeah, it sucks.  This has
happened to me twice in the past month and cost me about 10MB of
bandwidth (which is about 4% of my total usage so far this month).
So, I pronounce Mod_Rewrite Vendetta upon thee!  Here&#8217;s how to do it:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='apache'><span class='line'>    <span class="nb">RewriteCond</span> %{HTTP_REFERER} !^$
</span><span class='line'>    <span class="nb">RewriteCond</span> %{HTTP_REFERER} !^http://patrick.wagstrom.net/.*$ [NC]
</span><span class='line'>    <span class="nb">RewriteCond</span> %{HTTP_REFERER} !^http://192.168.*$
</span><span class='line'>    <span class="nb">RewriteCond</span> %{HTTP_REFERER} !^http://.*\.bloglines.com/.*$ [NC]
</span><span class='line'>    <span class="nb">RewriteCond</span> %{HTTP_REFERER} !^http://.*\.google.com/.*$ [NC]
</span><span class='line'>    <span class="nb">RewriteRule</span> ^/resources/images/.*\.(gif|png|jpg)$ <span class="sx">/resources/images/bandwidthThief.png</span> [L]
</span></code></pre></td></tr></table></div></figure>


<p>So what&#8217;s going on here?  Well, we&#8217;re checking the <code>HTTP_REFERER</code> header
to see where the person is coming from.  If it is not a direct link
(indicated by an empty referer), from somewhere on my site, from
within my local subnet, from <a href="http://www.bloglines.com/">Bloglines</a>,
or from <a href="http://www.google.com/webhp?complete=1">Google</a>, then it
matches this rule.  In those cases, it looks and sees if the request
is to an image in my image directory.  If is is, then it automagically
changes it so it shows the much smaller (3400 byte) bandwidth thief
graphic.</p>

<p>What&#8217;s the interesting thing is that when you deep link to anothers
image, or include it in a bulletin board posting, as was done here,
you&#8217;re completely at the mercy of the person who hosts the image.  I
could have easily changed that picture to something lewd, profane, or
just generally tasteless and made it look like it came from that user.
Or worse, I could hack up a graphic to make it look like the text in
the board so the person would appear to be saying naughty stuff.
Anyway, I&#8217;m not sure if I&#8217;ll leave this one on or not.  I&#8217;ve had mixed
success in the past with this sort of rule because of the number of
times it triggers when I don&#8217;t want it to.</p>
</div>


<script>
var idcomments_acct = 'de6c2d3e38f6fdb9bf16fa9f1904f35d';
var idcomments_post_id;
var idcomments_post_url;
</script>
<span id="IDCommentsPostTitle" style="display:none"></span>
<script type='text/javascript' src='http://www.intensedebate.com/js/genericCommentWrapperV2.js'></script>




  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Patrick Wagstrom</span></span>

      








  


<time datetime="2004-12-13T18:32:00-05:00" pubdate data-updated="true">Dec 13<span>th</span>, 2004</time>
      

<span class="categories">
  
    <a class='category' href='/weblog/blog/categories/meta/'>meta</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://patrick.wagstrom.net/weblog/2004/12/13/bandwidththief/" data-via="pridkett" data-counturl="http://patrick.wagstrom.net/weblog/2004/12/13/bandwidththief/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/weblog/2004/12/10/banninglinkspammers2/" title="Previous Post: Really Banning Link Spammers">&laquo; Really Banning Link Spammers</a>
      
      
        <a class="basic-alignment right" href="/weblog/2004/12/14/bloglinessubscribers/" title="Next Post: Figuring out Bloglines Subscribers">Figuring out Bloglines Subscribers &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/weblog/2012/05/10/static-bloggin/">Static Bloggin</a>
      </li>
    
      <li class="post">
        <a href="/weblog/2012/01/28/i-am-not-a-climatologist-and-neither-are-most-of-these-people/">I am not a climatologist, and neither are most of these people</a>
      </li>
    
      <li class="post">
        <a href="/weblog/2012/01/10/looking-for-summer-interns-in-the-software-technology-group-at-ibm-tj-watson-research-center/">Looking for Summer Interns in the Software Technology Group at IBM TJ Watson Research Center</a>
      </li>
    
      <li class="post">
        <a href="/weblog/2012/01/03/a-review-of-2011-personal-development-goals/">A Review of 2011 Personal Development Goals</a>
      </li>
    
      <li class="post">
        <a href="/weblog/2012/01/03/open-source-and-technology-predictions-for-2012/">Open Source and Technology Predictions for 2012</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/pridkett">@pridkett</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'pridkett',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/weblog/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("pridkett", 4, false);
    });
  </script>
  <script src="/weblog/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/pridkett" class="twitter-follow-button" data-show-count="false">Follow @pridkett</a>
  
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/102672530623465237388?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Patrick Wagstrom -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
